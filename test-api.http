### Variables
@baseUrl = http://localhost:8082
@contentType = application/json

### Register a new user
POST {{baseUrl}}/api/auth/register
Content-Type: {{contentType}}

{
  "username": "testuser",
  "password": "Test123!@#",
  "email": "test@example.com",
  "firstName": "Test",
  "lastName": "User",
  "roles": ["USER"]
}

### Login with registered user
POST {{baseUrl}}/api/auth/login
Content-Type: {{contentType}}

{
  "username": "testuser",
  "password": "Test123!@#"
}

### Refresh token
POST {{baseUrl}}/api/auth/refresh
Content-Type: {{contentType}}
Authorization: Bearer {{refreshToken}}

### Logout
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{accessToken}}

### Get current user profile
GET {{baseUrl}}/api/auth/profile
Authorization: Bearer {{accessToken}}

### Update user profile
PUT {{baseUrl}}/api/auth/profile
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "firstName": "Updated",
  "lastName": "Name",
  "email": "updated@example.com"
}

### Change password
PUT {{baseUrl}}/api/auth/change-password
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "currentPassword": "Test123!@#",
  "newPassword": "NewTest123!@#"
}

### Test rate limiting (try multiple times)
POST {{baseUrl}}/api/auth/login
Content-Type: {{contentType}}

{
  "username": "testuser",
  "password": "wrongpassword"
}

### Test token blacklist (after logout)
GET {{baseUrl}}/api/auth/profile
Authorization: Bearer {{blacklistedToken}}

### Test invalid token
GET {{baseUrl}}/api/auth/profile
Authorization: Bearer invalid.token.here

### Test missing token
GET {{baseUrl}}/api/auth/profile

### Test expired token
GET {{baseUrl}}/api/auth/profile
Authorization: Bearer {{expiredToken}}

### Test role-based access
GET {{baseUrl}}/api/auth/admin
Authorization: Bearer {{accessToken}}

### Test refresh token with invalid token
POST {{baseUrl}}/api/auth/refresh
Content-Type: {{contentType}}
Authorization: Bearer {{invalidRefreshToken}}

### Test refresh token with access token (should fail)
POST {{baseUrl}}/api/auth/refresh
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

### Get user profile (replace {token} with actual JWT token)
GET http://localhost:8081/api/users/profile
Authorization: Bearer {token}

### Create a budget (replace {token} with actual JWT token)
POST http://localhost:8082/api/budgets
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "Monthly Budget",
  "amount": 5000.00,
  "startDate": "2024-04-01",
  "endDate": "2024-04-30"
}

### Add income (replace {token} with actual JWT token)
POST http://localhost:8083/api/incomes
Authorization: Bearer {token}
Content-Type: application/json

{
  "amount": 3000.00,
  "description": "Salary",
  "date": "2024-04-27",
  "category": "SALARY"
}

### Create a transaction (replace {token} with actual JWT token)
POST http://localhost:8087/api/transactions
Authorization: Bearer {token}
Content-Type: application/json

{
  "amount": 100.00,
  "description": "Grocery shopping",
  "date": "2024-04-27",
  "category": "FOOD",
  "type": "EXPENSE"
} 